{"code":"!function(t){var e={},n={0:0};function o(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.e=function(e){if(0!==n[e]){var o=require(\"./\"+e+\".app.js\"),r=o.modules,a=o.ids;for(var i in r)t[i]=r[i];for(var c=0;c<a.length;c++)n[a[c]]=0}return Promise.all([])},o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,\"a\",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p=\"\",o.oe=function(t){process.nextTick((function(){throw t}))},o(o.s=\"CQCt\")}({\"+o4U\":function(t,e){t.exports=require(\"react-hot-loader/root\")},\"20ZA\":function(t){t.exports=JSON.parse('{\"js/0.9b3acdf1.js\":\"/js/0.9b3acdf1.js\",\"libs.js\":\"/js/libs.daa56172.js\",\"main.js\":\"/js/main.63e588e7.js\",\"js/3.bf7453e0.js\":\"/js/3.bf7453e0.js\",\"js/4.4b8e37a6.js\":\"/js/4.4b8e37a6.js\",\"img/img.f9bd91f4.jpg\":\"/img/img.f9bd91f4.jpg\"}')},\"5lGI\":function(t,e){t.exports=require(\"isomorphic-style-loader/StyleContext\")},\"7ITC\":function(t,e){t.exports=require(\"react-dom/server\")},\"989t\":function(t,e){t.exports=require(\"koa-static\")},CQCt:function(t,e,n){\"use strict\";n.r(e);var o=n(\"cDcd\"),r=n.n(o),a=n(\"7ITC\"),i=n(\"MGin\"),c=(n(\"iURj\"),n(\"oncg\")),s=n(\"+o4U\"),u=n(\"lUbX\"),l=n.n(u),p=n(\"rf1X\"),f=n.n(p);class d extends r.a.Component{constructor(t){super(t)}render(){return r.a.createElement(\"div\",{className:\"layout-box\"},r.a.createElement(\"h1\",null,\"koa+react+ssr\"),r.a.createElement(c.NavLink,{to:\"/index\",style:{marginLeft:\"10px\"}},\"首页\"),r.a.createElement(c.NavLink,{style:{marginLeft:\"10px\"},to:\"/list\"},\"列表页\"),this.props.children)}}var m=l()(f.a)(Object(s.hot)(d));function h(t){return r.a.createElement(\"div\",null,\"loading......\")}class y extends r.a.Component{constructor(t){super(t),this.state={mod:null}}componentDidMount(){this.state.mod||this.load(this.props)}load(t){this.setState({mod:null}),t.load().then(t=>{this.setState({mod:t.default?t.default:t})})}render(){return this.state.mod?this.props.children(this.state.mod):r.a.createElement(h,null)}}var g=n(\"M0Vd\"),v=n.n(g);var b=function(t){function e(e){return r.a.createElement(y,{load:t},t=>r.a.createElement(t,e))}return e[v.a.asyncComponentKey]=!0,e};var x=[{path:[\"/\",\"/index\"],component:b(()=>n.e(1).then(n.bind(null,\"RKbY\"))),exact:!0},{path:\"/list\",component:b(()=>n.e(2).then(n.bind(null,\"cYME\"))),exact:!0},{path:\"*\",component:function(){return r.a.createElement(\"div\",null,\"404页面\")},exact:!0}];r.a.createContext({});r.a.Component;function j(){return(j=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t}).apply(this,arguments)}var C=function({routeList:t}){return r.a.createElement(m,null,r.a.createElement(c.Switch,null,t.map(t=>r.a.createElement(c.Route,j({key:t.path},t)))))};var S=async function(t){const e=\"__dynamics_route_to_static\";if(global[e])return console.log(\"cache route\"),global[e];let n=t.length,o=0;const r=[];for(;o<n;o++){let e=t[o];(a=e.component)&&a[v.a.asyncComponentKey]?r.push({...e,component:(await e.component().props.load()).default}):r.push({...e})}var a;return global[e]=r,r},E=n(\"5lGI\"),O=n.n(E);const _=n(\"iiSy\");var k=n(\"vAnj\"),P=n.n(k),w=n(\"989t\"),q=n.n(w);n(\"oyvS\");const M=v.a.nodeServerPort||Object({NODE_ENV:\"production\"}).PORT,R=new P.a;R.use(q()(\"./dist/static\")),R.use(async(t,e)=>{console.log(\"production\"),console.log(\"string\"),console.log(!0),console.log(\"boolean\"),console.log(\"====\");const n=t.request.path;if(n.indexOf(\".\")>-1)return t.body=null,e();console.log(\"ctx.request.path\",t.request.path);const o=await S(x);let c,s=await((t,e)=>{let n,o;for(var r of e)if(o=Object(i.matchPath)(t,r),o){n=r;break}return{targetRoute:n,targetMatch:o}})(n,o),{targetRoute:u,targetMatch:l}=s,p={};u&&(c=u.component?u.component.getInitialProps:null,c&&(p=await c()));let{page:f}=p||{},d={title:\"默认标题 - my react ssr\",keywords:\"默认关键词\",description:\"默认描述\"};f&&f.tdk&&(d=f.tdk);const m={initialData:p},h=new Set,y=Object(a.renderToString)(r.a.createElement(i.StaticRouter,{location:n,context:m},r.a.createElement(O.a.Provider,{value:{insertCss:(...t)=>t.forEach(t=>h.add(t._getContent()))}},r.a.createElement(C,{routeList:o})))),g=[];[...h].forEach(t=>{let[e,n]=t[0];g.push(`<style id=\"s${e}-0\">${n}</style>`)});const v=_();t.body=`<!DOCTYPE html>\\n<html lang=\"en\">\\n<head>\\n    <meta charset=\"UTF-8\">\\n    <title>${d.title}</title>\\n    <meta name=\"keywords\" content=\"${d.keywords}\" />\\n    <meta name=\"description\" content=\"${d.description}\" />\\n    ${g.join(\"\")}\\n</head>\\n<body>\\n    <div id=\"root\">\\n       ${y}\\n    </div>\\n    <textarea id=\"ssrTextInitData\" style=\"display:none;\">\\n    ${JSON.stringify(p)}\\n    </textarea>\\n</body>\\n</html>\\n ${v.js.join(\"\")}\\n`,await e()}),R.listen(M),console.log(\"server is start .\",`http://localhost:${M}`)},JPst:function(t,e,n){\"use strict\";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=function(t,e){var n=t[1]||\"\",o=t[3];if(!o)return n;if(e&&\"function\"==typeof btoa){var r=(i=o,c=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),s=\"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(c),\"/*# \".concat(s,\" */\")),a=o.sources.map((function(t){return\"/*# sourceURL=\".concat(o.sourceRoot||\"\").concat(t,\" */\")}));return[n].concat(a).concat([r]).join(\"\\n\")}var i,c,s;return[n].join(\"\\n\")}(e,t);return e[2]?\"@media \".concat(e[2],\" {\").concat(n,\"}\"):n})).join(\"\")},e.i=function(t,n,o){\"string\"==typeof t&&(t=[[null,t,\"\"]]);var r={};if(o)for(var a=0;a<this.length;a++){var i=this[a][0];null!=i&&(r[i]=!0)}for(var c=0;c<t.length;c++){var s=[].concat(t[c]);o&&r[s[0]]||(n&&(s[2]?s[2]=\"\".concat(n,\" and \").concat(s[2]):s[2]=n),e.push(s))}},e}},M0Vd:function(t,e){t.exports={wdsPort:9002,nodeServerPort:9001,asyncComponentKey:\"__IS_ASYNC_COMP_FLAG__\"}},MGin:function(t,e){t.exports=require(\"react-router\")},Q8e5:function(t,e,n){\"use strict\";\n/*! Isomorphic Style Loader | MIT License | https://github.com/kriasoft/isomorphic-style-loader */var o={};function r(t){t.forEach((function(t){if(--o[t]<=0){var e=document.getElementById(t);e&&e.parentNode.removeChild(e)}}))}t.exports=function(t,e){for(var n,a=void 0===e?{}:e,i=a.replace,c=void 0!==i&&i,s=a.prepend,u=void 0!==s&&s,l=a.prefix,p=void 0===l?\"s\":l,f=[],d=0;d<t.length;d++){var m=t[d],h=m[0],y=m[1],g=m[2],v=m[3],b=\"\"+p+h+\"-\"+d;if(f.push(b),!o[b]||c){o[b]=1;var x=document.getElementById(b),j=!1;x||(j=!0,(x=document.createElement(\"style\")).setAttribute(\"type\",\"text/css\"),x.id=b,g&&x.setAttribute(\"media\",g));var C=y;v&&\"function\"==typeof btoa&&(C+=\"\\n/*# sourceMappingURL=data:application/json;base64,\"+(n=JSON.stringify(v),btoa(encodeURIComponent(n).replace(/%([0-9A-F]{2})/g,(function(t,e){return String.fromCharCode(\"0x\"+e)}))))+\"*/\",C+=\"\\n/*# sourceURL=\"+v.file+\"?\"+b+\"*/\"),\"textContent\"in x?x.textContent=C:x.styleSheet.cssText=C,j&&(u?document.head.insertBefore(x,document.head.childNodes[0]):document.head.appendChild(x))}else o[b]++}return r.bind(null,f)}},cDcd:function(t,e){t.exports=require(\"react\")},\"fk+k\":function(t,e,n){(e=n(\"JPst\")(!1)).push([t.i,\"body{background-color:#f4f5f5}.layout-box{max-width:750px;margin:0 auto;text-align:center;background:#fff}.layout-box h1{margin-top:20px;margin-top:20px}\\n\",\"\"]),t.exports=e},iURj:function(t,e){t.exports=require(\"react-router-config\")},iiSy:function(t,e,n){t.exports=function(){let t=[\"libs.js\",\"main.js\",\"styles.js\"],e=[\"styles.css\"];const o={js:[],css:[]};{const r=n(\"20ZA\");t.forEach(t=>{r[t]&&o.js.push(`<script type=\"text/javascript\"  src=\"${r[t]}\"><\\/script>`)}),e.forEach(t=>{r[t]&&o.css.push(`<link rel=\"stylesheet\" type=\"text/css\" href=\"${r[t]}\" />`)})}return o}},lUbX:function(t,e){t.exports=require(\"isomorphic-style-loader/withStyles\")},oncg:function(t,e){t.exports=require(\"react-router-dom\")},oyvS:function(t,e){t.exports=require(\"path\")},rf1X:function(t,e,n){var o=n(\"fk+k\"),r=n(\"Q8e5\"),a=\"string\"==typeof o?[[t.i,o,\"\"]]:o;(e=t.exports=o.locals||{})._getContent=function(){return a},e._getCss=function(){return\"\"+o},e._insertCss=function(t){return r(a,t)}},vAnj:function(t,e){t.exports=require(\"koa2\")}});","extractedComments":[]}