!function(t){var e={},n={0:0};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.e=function(e){if(0!==n[e]){var r=require("./"+e+".app.js"),o=r.modules,s=r.ids;for(var i in o)t[i]=o[i];for(var a=0;a<s.length;a++)n[s[a]]=0}return Promise.all([])},r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r.oe=function(t){process.nextTick((function(){throw t}))},r(r.s=24)}([function(t,e){t.exports=require("react")},function(t,e){t.exports={__IS_SSR__:!1,wdsPort:9002,nodeServerPort:9001,asyncComponentKey:"__IS_ASYNC_COMP_FLAG__"}},function(t,e){t.exports=require("path")},function(t,e){t.exports=require("react-router")},function(t,e){t.exports=require("react-router-dom")},function(t,e){t.exports=require("assert")},function(t,e){t.exports=require("debug")},function(t,e){t.exports=require("http-errors")},function(t,e){t.exports=require("any-promise")},function(t,e){t.exports=require("react-dom/server")},function(t,e){t.exports=require("react-hot-loader/root")},function(t,e){t.exports=require("koa2")},function(t,e,n){"use strict";const r=n(6)("koa-static"),{resolve:o}=n(2),s=n(5),i=n(16);t.exports=function(t,e){e=Object.assign({},e),s(t,"root directory is required to serve files"),r('static "%s" %j',t,e),e.root=o(t),!1!==e.index&&(e.index=e.index||"index.html");if(!e.defer)return async function(t,n){let r=!1;if("HEAD"===t.method||"GET"===t.method)try{r=await i(t,t.path,e)}catch(t){if(404!==t.status)throw t}r||await n()};return async function(t,n){if(await n(),("HEAD"===t.method||"GET"===t.method)&&null==t.body&&404===t.status)try{await i(t,t.path,e)}catch(t){if(404!==t.status)throw t}}}},function(t,e){t.exports=require("react-router-config")},function(t,e,n){const r=n(1);t.exports=function(){global.__LOCAL__IP__,r.wdsPort;let t=["libs.js","main.js","styles.js"],e=["styles.css"];const o={js:[],css:[]};{const r=n(15);t.forEach(t=>{r[t]&&o.js.push(`<script type="text/javascript"  src="${r[t]}"><\/script>`)}),e.forEach(t=>{r[t]&&o.css.push(`<link rel="stylesheet" type="text/css" href="${r[t]}" />`)})}return o}},function(t){t.exports=JSON.parse('{"styles.css":"/css/styles.184e2f69.css","styles.js":"/js/styles.fd0c9d5d.js","js/1.95da4855.js":"/js/1.95da4855.js","libs.js":"/js/libs.5c038512.js","main.js":"/js/main.b9c617c7.js","js/4.0d06854e.js":"/js/4.0d06854e.js","js/5.2d091f62.js":"/js/5.2d091f62.js","img/img.f9bd91f4.jpg":"/img/img.f9bd91f4.jpg"}')},function(t,e,n){const r=n(6)("koa-send"),o=n(17),s=n(7),i=n(5),a=n(19),{normalize:c,basename:u,extname:l,resolve:f,parse:p,sep:d}=n(2);t.exports=async function(t,e,n={}){i(t,"koa context required"),i(e,"pathname required"),r('send "%s" %j',e,n);const h=n.root?c(f(n.root)):"",m="/"===e[e.length-1];e=e.substr(p(e).root.length);const y=n.index,g=n.maxage||n.maxAge||0,_=n.immutable||!1,b=n.hidden||!1,x=!1!==n.format,w=!!Array.isArray(n.extensions)&&n.extensions,v=!1!==n.brotli,j=!1!==n.gzip,$=n.setHeaders;if($&&"function"!=typeof $)throw new TypeError("option setHeaders must be function");if(-1===(e=function(t){try{return decodeURIComponent(t)}catch(t){return-1}}(e)))return t.throw(400,"failed to decode");y&&m&&(e+=y);if(e=o(h,e),!b&&function(t,e){e=e.substr(t.length).split(d);for(let t=0;t<e.length;t++)if("."===e[t][0])return!0;return!1}(h,e))return;let E,k="";"br"===t.acceptsEncodings("br","identity")&&v&&await a.exists(e+".br")?(e+=".br",t.set("Content-Encoding","br"),t.res.removeHeader("Content-Length"),k=".br"):"gzip"===t.acceptsEncodings("gzip","identity")&&j&&await a.exists(e+".gz")&&(e+=".gz",t.set("Content-Encoding","gzip"),t.res.removeHeader("Content-Length"),k=".gz");if(w&&!/\.[^/]*$/.exec(e)){const t=[].concat(w);for(let n=0;n<t.length;n++){let r=t[n];if("string"!=typeof r)throw new TypeError("option extensions must be array of strings or false");if(/^\./.exec(r)||(r="."+r),await a.exists(e+r)){e+=r;break}}}try{if(E=await a.stat(e),E.isDirectory()){if(!x||!y)return;e+="/"+y,E=await a.stat(e)}}catch(t){if(["ENOENT","ENAMETOOLONG","ENOTDIR"].includes(t.code))throw s(404,t);throw t.status=500,t}$&&$(t.res,e,E);t.set("Content-Length",E.size),t.response.get("Last-Modified")||t.set("Last-Modified",E.mtime.toUTCString());if(!t.response.get("Cache-Control")){const e=["max-age="+(g/1e3|0)];_&&e.push("immutable"),t.set("Cache-Control",e.join(","))}t.type||(t.type=(O=e,C=k,l(""!==C?u(O,C):O)));var O,C;return t.body=a.createReadStream(e),e}},function(t,e,n){"use strict";
/*!
 * resolve-path
 * Copyright(c) 2014 Jonathan Ong
 * Copyright(c) 2015-2018 Douglas Christopher Wilson
 * MIT Licensed
 */var r=n(7),o=n(2).join,s=n(2).normalize,i=n(18),a=n(2).resolve,c=n(2).sep;t.exports=function(t,e){var n=e,l=t;1===arguments.length&&(n=t,l=process.cwd());if(null==l)throw new TypeError("argument rootPath is required");if("string"!=typeof l)throw new TypeError("argument rootPath must be a string");if(null==n)throw new TypeError("argument relativePath is required");if("string"!=typeof n)throw new TypeError("argument relativePath must be a string");if(-1!==n.indexOf("\0"))throw r(400,"Malicious Path");if(i.posix(n)||i.win32(n))throw r(400,"Malicious Path");if(u.test(s("."+c+n)))throw r(403);return s(o(a(l),n))};var u=/(?:^|[\\/])\.\.(?:[\\/]|$)/},function(t,e){t.exports=require("path-is-absolute")},function(t,e,n){var r,o=n(8);try{r=n(20)}catch(t){r=n(21)}var s=["appendFile","chmod","chown","close","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","lchown","link","lstat","mkdir","open","read","readFile","readdir","readlink","realpath","rename","rmdir","stat","symlink","truncate","unlink","utimes","write","writeFile"];"function"==typeof r.access&&s.push("access"),"function"==typeof r.copyFile&&s.push("copyFile"),"function"==typeof r.mkdtemp&&s.push("mkdtemp"),n(22).withCallback(r,e,s),e.exists=function(t,e){return"function"==typeof e?r.stat(t,(function(t){e(null,!t)})):new o((function(e){r.stat(t,(function(t){e(!t)}))}))}},function(t,e){t.exports=require("graceful-fs")},function(t,e){t.exports=require("fs")},function(t,e,n){var r=n(23);function o(t,e,n){return s(t,e,n,r)}function s(t,e,n,r){return e||(e={},n=Object.keys(t)),Array.isArray(e)&&(n=e,e={}),n||(n=Object.keys(t)),"function"==typeof t&&(e=r(t)),n.forEach((function(n){"function"==typeof t[n]&&(e[n]=r(t[n]))})),Object.keys(t).forEach((function(n){(function(t,e){var n=Object.getOwnPropertyDescriptor(t,e);return!(!n||!n.get)&&"deprecated"===n.get.name})(t,n)||e[n]||(e[n]=t[n])})),e}t.exports=o,o.withCallback=function(t,e,n){return s(t,e,n,r.withCallback)},o.thenify=r},function(module,exports,__webpack_require__){var Promise=__webpack_require__(8),assert=__webpack_require__(5);function thenify($$__fn__$$,options){return assert("function"==typeof $$__fn__$$),eval(createWrapper($$__fn__$$.name,options))}function createCallback(t,e,n){return function(r,o){if(r)return e(r);var s=arguments.length;if(s<=2||!n)return t(o);if(Array.isArray(n)){for(var i={},a=1;a<s;a++)i[n[a-1]]=arguments[a];return t(i)}for(i=new Array(s-1),a=1;a<s;++a)i[a-1]=arguments[a];t(i)}}function createWrapper(t,e){t=(t||"").replace(/\s|bound(?!$)/g,"");var n=void 0===(e=e||{}).multiArgs||e.multiArgs;return"(function "+t+"() {\nvar self = this\nvar len = arguments.length\n"+(n="var multiArgs = "+JSON.stringify(n)+"\n")+(e.withCallback?'var lastType = typeof arguments[len - 1]\nif (lastType === "function") return $$__fn__$$.apply(self, arguments)\n':"")+"var args = new Array(len + 1)\nfor (var i = 0; i < len; ++i) args[i] = arguments[i]\nvar lastIndex = i\nreturn new Promise(function (resolve, reject) {\nargs[lastIndex] = createCallback(resolve, reject, multiArgs)\n$$__fn__$$.apply(self, args)\n})\n})"}module.exports=thenify,thenify.withCallback=function($$__fn__$$,options){return assert("function"==typeof $$__fn__$$),options=options||{},options.withCallback=!0,void 0===options.multiArgs&&(options.multiArgs=!0),eval(createWrapper($$__fn__$$.name,options))}},function(t,e,n){"use strict";n.r(e);var r=n(0),o=n.n(r),s=n(9),i=n(3),a=(n(13),n(4)),c=n(10);class u extends o.a.Component{constructor(t){super(t)}render(){return o.a.createElement("div",{className:"layout-box"},o.a.createElement("h1",null,"zz.js ---\x3e koa+react+ssr"),this.props.children)}}var l=Object(c.hot)(u);function f(t){return o.a.createElement("div",null,"loading......")}class p extends o.a.Component{constructor(t){super(t),this.state={mod:null}}componentDidMount(){this.state.mod||this.load(this.props)}load(t){this.setState({mod:null}),t.load().then(t=>{this.setState({mod:t.default?t.default:t})})}render(){return this.state.mod?this.props.children(this.state.mod):o.a.createElement(f,null)}}var d=n(1),h=n.n(d);var m=function(t){function e(e){return o.a.createElement(p,{load:t},t=>o.a.createElement(t,e))}return e[h.a.asyncComponentKey]=!0,e};var y=[{path:["/","/index"],component:m(()=>n.e(2).then(n.bind(null,28))),exact:!0},{path:"/detail/:id",component:m(()=>n.e(1).then(n.bind(null,29))),exact:!0},{path:"*",component:function({staticContext:t}){return t&&(t.code=404),o.a.createElement("div",null,"404页面")},exact:!0}];o.a.createContext({});o.a.Component;function g(){return(g=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}var _=function({routeList:t}){return o.a.createElement(l,null,o.a.createElement(a.Switch,null,t.map(t=>o.a.createElement(a.Route,g({key:t.path},t)))))};const b=t=>t&&t[h.a.asyncComponentKey];var x=async function(t){const e="__dynamics_route_to_static";if(global[e])return console.log("cache route"),global[e];let n=t.length,r=0;const o=[];for(;r<n;r++){let e=t[r];b(e.component)?o.push({...e,component:(await e.component().props.load()).default}):o.push({...e})}return global[e]=o,o};const w=n(14);var v=n(11),j=n.n(v),$=n(12),E=n.n($);n(2);const k=h.a.nodeServerPort||Object({NODE_ENV:"production"}).PORT,O=new j.a;O.use(E()("./dist/static")),O.use(async(t,e)=>{console.log("production"),console.log("string"),console.log(!0),console.log("boolean"),console.log("====");const n=t.request.path;if(n.indexOf(".")>-1)return t.body=null,e();console.log("ctx.request.path",t.request.path);let r="",a={},c={title:"默认标题 - my react ssr",keywords:"默认关键词",description:"默认描述"};if(h.a.__IS_SSR__){const t=await x(y);let e,u=await((t,e)=>{let n,r;for(var o of e)if(r=Object(i.matchPath)(t,o),r){n=o;break}return{targetRoute:n,targetMatch:r}})(n,t),{targetRoute:l,targetMatch:f}=u;l&&(e=l.component?l.component.getInitialProps:null,e&&(a=await e({match:f})));let{page:p}=a||{};p&&p.tdk&&(c=p.tdk);const d={initialData:a};r=Object(s.renderToString)(o.a.createElement(i.StaticRouter,{location:n,context:d},o.a.createElement(_,{routeList:t})))}const u=w();t.body=`<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <title>${c.title}</title>\n    <meta name="keywords" content="${c.keywords}" />\n    <meta name="description" content="${c.description}" />\n     ${u.css.join("")}\n</head>\n<body>\n    <div id="root">\n       ${r}\n    </div>\n    <textarea id="ssrTextInitData" style="display:none;">\n    ${JSON.stringify(a)}\n    </textarea>\n</body>\n</html>\n</body>\n<script>\nwindow.__IS__SSR__=${h.a.__IS_SSR__};\n<\/script>\n ${u.js.join("")}\n`,await e()}),O.listen(k),console.log("server is start .",`http://localhost:${k}`)},function(t,e){t.exports=require("axios")}]);